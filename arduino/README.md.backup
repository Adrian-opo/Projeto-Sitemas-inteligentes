# Sistema de Controle - Garra RobÃ³tica com QR Code

Sistema completo de automaÃ§Ã£o com Arduino Mega 2560, servos, motores de passo e leitura de QR Code.

## ğŸ“‹ Componentes

### Hardware
- **Arduino Mega 2560**
- **Servos** (4x):
  - Pino 3: Garra
  - Pino 5: Base
  - Pino 8: AntebraÃ§o
  - Pino 10: BraÃ§o
- **Motores de Passo** (2x - 28BYJ-48):
  - Motor 1: Pinos 30, 31, 32, 33
  - Motor 2: Pinos 36, 37, 38, 39
- **CÃ¢mera** (webcam USB para leitura de QR Code)

### Software
- PlatformIO
- Python 3.x
- OpenCV
- PySerial
- Pyzbar

## ğŸš€ InstalaÃ§Ã£o

### 1. DependÃªncias Python

```bash
pip install pyserial opencv-python pyzbar
```

### 2. Compilar e Fazer Upload do Firmware

```bash
cd /home/renan/Documentos/PlatformIO/Projects/TESTESMOTOR
pio run --target upload
```

### 3. Executar o Sistema Python

```bash
python3 controle_sistema.py
```

## ğŸ“– Funcionamento

### Ciclo Completo AutomÃ¡tico

1. **Pegar Objeto**: A garra se move e captura o objeto
2. **Ler QR Code**: Sistema aguarda QR Code para determinar destino
3. **Posicionar**: Move base e antebraÃ§o para posiÃ§Ã£o de seleÃ§Ã£o
4. **Soltar**: Deposita objeto na esteira
5. **Retornar**: Volta Ã  posiÃ§Ã£o inicial

### Destinos QR Code

Os QR Codes devem conter uma letra (A-E):

| QR Code | Base (Â°) | AntebraÃ§o (Â°) |
|---------|----------|---------------|
| A       | 0        | 130           |
| B       | 45       | 130           |
| C       | 90       | 130           |
| D       | 135      | 130           |
| E       | 180      | 130           |

## ğŸ® Comandos DisponÃ­veis

### Via Python (Recomendado)
Execute `python3 controle_sistema.py` e use o menu interativo.

### Via Serial (Monitor Serial)

#### Servos
- `C` - CalibraÃ§Ã£o inicial
- `P` - Pegar objeto
- `E` - Colocar na esteira
- `V` - Voltar posiÃ§Ã£o inicial
- `S` - SequÃªncia completa
- `G<Ã¢ngulo>` - Mover garra (ex: G90)
- `B<Ã¢ngulo>` - Mover base (ex: B180)
- `A<Ã¢ngulo>` - Mover antebraÃ§o (ex: A60)
- `R<Ã¢ngulo>` - Mover braÃ§o (ex: R120)

#### Motores de Passo
- `M` - Teste motores (ambos)
- `1F<passos>` - Motor 1 frente (ex: 1F100)
- `1B<passos>` - Motor 1 trÃ¡s (ex: 1B100)
- `2F<passos>` - Motor 2 frente (ex: 2F100)
- `2B<passos>` - Motor 2 trÃ¡s (ex: 2B100)
- `Z` - Zerar posiÃ§Ãµes
- `?` - Mostrar posiÃ§Ã£o atual

#### Sistema Integrado
- `QR<base>,<antebraÃ§o>` - Mover para seleÃ§Ã£o (ex: QR45,90)
- `CICLO` - Ciclo completo

## ğŸ”§ Testes de Motores de Passo

O firmware agora mostra em tempo real a posiÃ§Ã£o dos motores:

```
â†’ Enviado: 1F100
â† Arduino: Motor1 FRENTE - 100 passos
â† Arduino: POS:10,0|GRAUS:1.8,0.0
â† Arduino: POS:20,0|GRAUS:3.5,0.0
â† Arduino: POS:30,0|GRAUS:5.3,0.0
...
â† Arduino: POS:100,0|GRAUS:17.6,0.0
```

### Formato da SaÃ­da de PosiÃ§Ã£o

`POS:X,Y|GRAUS:A,B`

- **X, Y**: PosiÃ§Ã£o em passos (Motor 1, Motor 2)
- **A, B**: PosiÃ§Ã£o em graus (Motor 1, Motor 2)

## ğŸ“Š Fluxo do Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ InicializaÃ§Ã£o   â”‚
â”‚ - CalibraÃ§Ã£o    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pegar Objeto    â”‚
â”‚ - Move garra    â”‚
â”‚ - Captura       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ler QR Code     â”‚
â”‚ - CÃ¢mera ativa  â”‚
â”‚ - Detecta dest. â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Posicionar      â”‚
â”‚ - Move servos   â”‚
â”‚ - Base + Ante.  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Soltar Objeto   â”‚
â”‚ - Esteira       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Retornar        â”‚
â”‚ - Pos. inicial  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› Troubleshooting

### CÃ¢mera nÃ£o detectada
```python
# Tente diferentes Ã­ndices
controlador.inicializar_camera(indice=1)  # ou 2, 3...
```

### Porta serial incorreta
- Linux: Geralmente `/dev/ttyACM0` ou `/dev/ttyUSB0`
- Windows: `COM3`, `COM4`, etc.

Para listar portas:
```bash
ls /dev/tty*
```

### QR Code nÃ£o Ã© lido
- Certifique-se de boa iluminaÃ§Ã£o
- Mantenha o QR Code estÃ¡vel
- Aumente o tamanho do QR Code
- Ajuste a distÃ¢ncia da cÃ¢mera

### Motores de passo nÃ£o giram suavemente
- Verifique conexÃµes dos pinos
- Confirme alimentaÃ§Ã£o adequada (5V para 28BYJ-48)
- Teste com comandos pequenos primeiro (50-100 passos)

## ğŸ“ Exemplos de Uso

### Teste RÃ¡pido de Motores

Via Python:
```python
controlador.enviar_comando('1F100')  # Motor 1, 100 passos frente
controlador.enviar_comando('?')      # Mostra posiÃ§Ã£o
controlador.enviar_comando('Z')      # Zera contadores
```

Via Monitor Serial:
```
1F100
?
Z
```

### Ciclo Completo Manual

```python
controlador.enviar_comando('C')      # Calibra
time.sleep(2)
controlador.enviar_comando('P')      # Pega objeto
# ... mostra QR Code ...
controlador.enviar_comando('QR90,130')  # Move para posiÃ§Ã£o C
controlador.enviar_comando('E')      # Solta na esteira
controlador.enviar_comando('V')      # Volta
```

## ğŸ“„ Estrutura do Projeto

```
TESTESMOTOR/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main.cpp              # Firmware Arduino
â”œâ”€â”€ controle_sistema.py       # Interface Python
â”œâ”€â”€ platformio.ini           # ConfiguraÃ§Ã£o PlatformIO
â””â”€â”€ README.md                # Este arquivo
```

## ğŸ” LicenÃ§a

Projeto educacional - Livre para uso e modificaÃ§Ã£o

## ğŸ‘¤ Autor

Sistema automatizado - 2025
